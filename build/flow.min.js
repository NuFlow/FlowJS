!function(){"use strict";function t(){const t=this;if(!t.flowRunning)if(t.flowRunning=!0,0!==t.pipes.events.length)for(const e of t.pipes.events)i.call(t,-1,e);else{const e=t.pipes.targets[0];i.call(t,0,e)}}function i(t,i,s){const r=i.params;s&&r.push(s);const o=this;function n(){e.call(o,t+1,...Array.from(arguments))}r.push(n);const c=i.target.apply({},r);"object"===typeof c&&c instanceof Promise&&c.then(((...t)=>n.apply(null,[null,...Array.from(t)])))}function e(t,e,s){const r=this.pipes.targets[t];if(!e)return r&&r.target?void i.call(this,t,r,s):(this.flowRunning=!1,void(this.promisified.isPromised&&(this.promisified.resolve(s),this.promisified.isPromised=!1)))}const s=function(t){return u.call(this,"init",t,Array.from(arguments).slice(1))},r=function(t){return u.call(this,"to",t,Array.from(arguments).slice(1))},o=function(t){return u.call(this,"from",t,Array.from(arguments).slice(1))},n=function(){if(this.promisified.isPromised)return new Promise(((i,e)=>{this.promisified.resolve=i,this.promisified.reject=e,t.call(this)}));t.call(this)},c=function(){return this.promisified.isPromised=!0,this};function u(t,i,e){if("function"!=typeof i)throw new Error('Flow expected a function but received "'+typeof i+'" instead!');const s={direction:t,target:i,params:e},r=this;switch(s.direction){case"init":if(!function(t){try{return Reflect.construct(String,[],t),!0}catch(t){return!1}}(i))throw new Error("Flow target is not a constructor!");const t=new i(...e);r.pipes.init.push(t);break;case"from":r.pipes.events.push(s);break;case"to":r.pipes.targets.push(s);break;default:console.warn("WARNING: Flow has received an unknown pipe direction. Please post a bug to the author about this.")}return this}class l{pipes={init:[],events:[],targets:[]};flowRunning=!1;promisified={isPromised:!1,resolve:()=>{},reject:()=>{}};init=s;to=r;from=o;run=n;promisify=c;static modules={};modules={};thread(){return new l}static use(t,i){if(this.modules[t])throw new Error(t+" collides with existing Flow module or property.");this.modules[t]=i}constructor(){return this.modules=this.constructor.modules,new Proxy(this,{get:function(t,i){return Reflect.has(t,i)?Reflect.get(t,i):Reflect.has(t.modules,i)?t.modules[i]:void 0}})}}}();
